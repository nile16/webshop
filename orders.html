<!DOCTYPE html>

<head>

	<title>Order Viewer</title>
	<meta charset='utf-8' />
	<meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<style>

#wrapper{
	position:absolute;
	left:30px;
	right:30px;
	top:30px;
	bottom:30px;
}


</style>

<body>
	<div id="wrapper">
	</div>
</body>

<script>

function time(s) {
    return new Date(s*1000).toISOString();
}

function getOrders(){

	// Create an instance of the XMLHttpRequset class. See http://www.w3schools.com/xml/xml_http.asp for info
	var xhr = new XMLHttpRequest();

	// Specify POST request and the server's url
	xhr.open("GET", 'http://nile16.nu:1204/listorders', true);

	// Specify what will happen when a response from the server arrives
	xhr.onreadystatechange = function(){

		// If the status code is okay (200) then start print the result, otherwise do nothing (keep waiting)
		if(this.readyState == 4 && this.status == 200) {

			// The response text was sent as JSON from the server and this converts the JSON back to an array of arrays
			orders=JSON.parse(xhr.responseText);
			for (i=0;i<orders.length;i++) {
				wrapper.innerHTML+="Order:<b>"+orders[i][1]+"</b> Time:<b>"+time(orders[i][2])+"</b> Name:<b>"+orders[i][3]+" "+orders[i][4]+"</b> SSN:<b>"+orders[i][5]+"</b> Address:<b>"+orders[i][6]+"</b> City:<b>"+orders[i][7]+"</b> Email:<b>"+orders[i][8]+"</b> Phone:<b>"+orders[i][9]+"</b><br>";
				wrapper.innerHTML+="-------------------------------------------<br>";
				for (j=0;j<orders[i][10].length;j++) {
					wrapper.innerHTML+=orders[i][10][j]+"<br>";
				}
			wrapper.innerHTML+="-------------------------------------------<br><br>";
			}
		}
	}
	xhr.send("");
}

getOrders();

</script>

</html>
